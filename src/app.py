import os
import json
import re
from fastapi import FastAPI, HTTPException, Path, Request
from fastapi.responses import JSONResponse
from typing import Dict

app = FastAPI()

# POST
@app.post("/post")
async def post_website(request: Request):
    data = await request.json()

    ip_addresses = []
    for website in data["websites"]:
        # Extract ip address from website
        pattern = re.compile(r'^(https?://)?(www\.)?([a-zA-Z0-9-]+)\.([a-zA-Z]{2,})(/[a-zA-Z0-9-._/]*)*$')
        is_url =  bool(pattern.match(website))
        if is_url:
            ip_addresses.append(website)
        else:
            ip_addresses.append('0')

    return {"ip_addresses": ip_addresses}

# GET
